<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FuelIQ - Your Intelligent Nutrition Companion</title>
  <link rel="preload" href="enhanced-integration-system.js" as="script">
  <link rel="preload" href="meals-tab.js" as="script">
  <link rel="preload" href="meal-planning.js" as="script">
  <link rel="preload" href="grocery-delivery.js" as="script">
  <link rel="preload" href="pantry-tab.js" as="script">
  <link rel="preload" href="weight-journey.js" as="script">
  <script src="profile-tab.js"></script>
  <link rel="preload" href="wearables-tab.js" as="script">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .text-gradient {
      background: linear-gradient(to right, #ea580c, #dc2626);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .bg-gradient-orange-red {
      background: linear-gradient(to right, #ea580c, #dc2626, #ec4899);
    }
    .bg-gradient-card {
      background: linear-gradient(135deg, #fed7aa, #fecaca, #fbb6ce);
    }
  </style>
</head>
<body>
  <div id="root"></div>
  <script src="unified-data-manager.js"></script>
  <script src="enhanced-integration-system.js"></script>
  <script src="meals-tab.js"></script>
  <script src="pantry-tab.js"></script>
  <script src="weight-journey.js"></script>
  <script src="meal-planning.js"></script>
  <script src="grocery-delivery.js"></script>
  <script src="analytics-tab.js"></script>
  <script src="wearables-tab.js"></script>
  <script>
    const { useState, useEffect, useMemo } = React;
    const { createElement: e } = React;

    function FuelIQ() {
      const [currentView, setCurrentView] = useState('profile');
    // NAVIGATION EVENT LISTENER - ADD THIS
useEffect(() => {
  const handleNavigate = (e) => {
    console.log('🚀 Navigation event received:', e.detail.tab);
    setCurrentView(e.detail.tab);
  };
  
  window.addEventListener('fueliq-navigate', handleNavigate);
  window.setCurrentView = setCurrentView; // Direct method
  
  return () => {
    window.removeEventListener('fueliq-navigate', handleNavigate);
    window.setCurrentView = null;
  };
}, [setCurrentView]);
    // Expose navigation globally for other tabs
    useEffect(() => {
      window.setCurrentView = setCurrentView;
      console.log('✅ Navigation exposed globally');
      
      return () => {
        window.setCurrentView = null;
      };
    }, [setCurrentView]);
    
    const [userProfile, setUserProfile] = useState({
        name: '',
        age: '',
        weight: '',
        height: '',
        gender: 'male',
        activityLevel: 'moderate',
        goal: 'fat_loss',
        dietaryRestrictions: [],
        allergies: [],
        healthConcerns: [],
        antiBloutPreference: false,
        // New food preferences
        foodsILove: [],
        foodsIAvoid: [],
        cuisinePreferences: []
      });
      const [goals, setGoals] = useState({});
      const [meals, setMeals] = useState([]);

      // Enhanced container cleanup function
     const clearContainer = (containerId) => {
  const container = document.getElementById(containerId);
  if (container) {
    try {
      // Safer React-compatible cleanup
      if (window.ReactDOM && window.ReactDOM.unmountComponentAtNode) {
        window.ReactDOM.unmountComponentAtNode(container);
      }
      
      // Simple innerHTML clear (React-safe)
      container.innerHTML = '';
      
      // Clear any inline styles
      container.style.cssText = '';
      
      // Reset classes to default
      container.className = 'meals-tab-content';
      
      console.log(`✅ Container ${containerId} cleared successfully`);
    } catch (e) {
      console.warn(`⚠️ Error clearing container ${containerId}:`, e);
      // Fallback: just clear innerHTML
      container.innerHTML = '';
    }
  }
};

      // Enhanced cleanup function
      const forceCleanup = () => {
        // Clean all possible containers
        ['meals-container', 'journey-container', 'pantry-container', 'planning-container', 'grocery-container', 'analytics-container', 'wearables-container'].forEach(id => {
          clearContainer(id);
        });
        
        // Clear any global event listeners that might be stuck
        if (window.FuelIQMeals && window.FuelIQMeals.cleanup) {
          window.FuelIQMeals.cleanup();
        }
        if (window.FuelIQWeightJourney && window.FuelIQWeightJourney.cleanup) {
          window.FuelIQWeightJourney.cleanup();
        }
        if (window.FuelIQPantry && window.FuelIQPantry.cleanup) {
          window.FuelIQPantry.cleanup();
        }
        if (window.FuelIQMealPlanning && window.FuelIQMealPlanning.cleanup) {
          window.FuelIQMealPlanning.cleanup();
        }
        if (window.FuelIQGroceryDelivery && window.FuelIQGroceryDelivery.cleanup) {
          window.FuelIQGroceryDelivery.cleanup();
        }
        if (window.FuelIQAnalytics && window.FuelIQAnalytics.cleanup) {
          window.FuelIQAnalytics.cleanup();
        }
        if (window.FuelIQWearables && window.FuelIQWearables.cleanup) {
          window.FuelIQWearables.cleanup();
        }
      };

      // Calculate TDEE and macro goals
      const calculateGoals = (profile) => {
        const { age, weight, height, gender, activityLevel, goal } = profile;
        
        if (!age || !weight || !height) return {};
        
        const weightKg = weight / 2.205;
        
        let bmr;
        if (gender === 'male') {
          bmr = 10 * weightKg + 6.25 * (height * 2.54) - 5 * age + 5;
        } else {
          bmr = 10 * weightKg + 6.25 * (height * 2.54) - 5 * age - 161;
        }
        
        const activityMultipliers = {
          sedentary: 1.2,
          light: 1.375,
          moderate: 1.55,
          active: 1.725,
          very_active: 1.9
        };
        
        const tdee = bmr * activityMultipliers[activityLevel];
        
        const goalAdjustments = {
          fat_loss: -500,
          muscle_gain: 300,
          maintenance: 0,
          recomp: -200
        };
        
        const targetCalories = tdee + goalAdjustments[goal];
        
        const proteinPerKg = goal === 'muscle_gain' ? 2.2 : goal === 'fat_loss' ? 2.0 : 1.8;
        const proteinGrams = (weightKg * proteinPerKg);
        const proteinCalories = proteinGrams * 4;
        
        const fatPercentage = goal === 'fat_loss' ? 0.25 : 0.30;
        const fatCalories = targetCalories * fatPercentage;
        const fatGrams = fatCalories / 9;
        
        const carbCalories = targetCalories - proteinCalories - fatCalories;
        const carbGrams = carbCalories / 4;
        
        return {
          calories: Math.round(targetCalories),
          protein: Math.round(proteinGrams),
          carbs: Math.round(carbGrams),
          fat: Math.round(fatGrams),
          water: Math.round(weight * 0.67)
        };
      };

      // Load saved user profile when returning to setup page
useEffect(() => {
  if (currentView === 'setup') {
    console.log('🔄 Setup page activated - loading saved data...');
    
    try {
      // Try unified data manager first (if available)
      if (window.UnifiedDataManager) {
        const savedProfile = window.UnifiedDataManager.getUserProfile();
        const savedGoals = window.UnifiedDataManager.getGoals();
        
        if (savedProfile) {
          console.log('✅ Loaded profile from unified data manager:', savedProfile);
          setUserProfile(savedProfile);
        }
        
        if (savedGoals) {
          console.log('✅ Loaded goals from unified data manager:', savedGoals);
          setGoals(savedGoals);
        }
      } else {
        // Fallback to localStorage
        const savedProfile = localStorage.getItem('fueliq_user_profile');
        if (savedProfile) {
          const parsedProfile = JSON.parse(savedProfile);
          console.log('✅ Loaded profile from localStorage:', parsedProfile);
          setUserProfile(parsedProfile);
        } else {
          console.log('ℹ️ No saved profile found - showing empty form');
        }
      }
    } catch (e) {
      console.warn('❌ Error loading saved data:', e);
    }
  }
}, [currentView]); // Key change: depend on currentView
      // Calculate goals when user profile changes
      useEffect(() => {
        if (userProfile.age && userProfile.weight && userProfile.height) {
          setGoals(calculateGoals(userProfile));
        }
      }, [userProfile]);

      // Enhanced cleanup on view change
      useEffect(() => {
        forceCleanup();
      }, [currentView]);

      // Goals sync for meals tab - UPDATED VERSION
useEffect(() => {
  if (currentView === 'meals') {
    // Ensure goals are available using your data manager
    let userGoalsData;
    
    if (window.FuelIQDataManager) {
      const goals = window.FuelIQDataManager.getGoals();
      userGoalsData = {
        dailyCalories: goals.calories,
        calories: goals.calories, // Both formats for compatibility
        protein: goals.protein,
        carbs: goals.carbs,
        fat: goals.fat
      };
    } else if (goals.calories) {
      userGoalsData = {
        dailyCalories: goals.calories,
        calories: goals.calories,
        protein: goals.protein,
        carbs: goals.carbs,
        fat: goals.fat
      };
    }
    
    if (userGoalsData) {
      try {
        localStorage.setItem('fueliq_user_goals', JSON.stringify(userGoalsData));
        console.log('✅ Goals synchronized for meals tab:', userGoalsData);
      } catch (e) {
        console.warn('localStorage not available:', e);
      }
    }
  }
}, [currentView, goals]);

      // Simplified meals tab rendering
useEffect(() => {
  if (currentView === 'meals') {
    clearContainer('meals-container');
    
    // Ensure goals are available first
    if (window.FuelIQDataManager) {
      const goals = window.FuelIQDataManager.getGoals();
      localStorage.setItem('fueliq_user_goals', JSON.stringify(goals));
      console.log('✅ Goals synchronized for meals tab');
    }
    
    // Simple retry mechanism  
    let retryCount = 0;
    const maxRetries = 3;
    
    const tryRenderMeals = () => {
      if (window.FuelIQMeals && window.FuelIQMeals.renderMealsTab) {
        try {
          window.FuelIQMeals.renderMealsTab('meals-container');
          console.log('✅ Meals tab rendered successfully');
        } catch (error) {
          console.error('Error rendering meals tab:', error);
        }
      } else {
        retryCount++;
        if (retryCount < maxRetries) {
          console.log(`⏳ Waiting for meals module... (${retryCount}/${maxRetries})`);
          setTimeout(tryRenderMeals, 1000);
        } else {
          console.warn('❌ Meals module failed to load');
          const container = document.getElementById('meals-container');
          if (container) {
            container.innerHTML = `
              <div class="max-w-6xl mx-auto p-6">
                <div class="bg-orange-50 border border-orange-200 rounded-xl p-6">
                  <h2 class="text-xl font-bold text-orange-800 mb-2">🍽️ Meals Tab Issue</h2>
                  <p class="text-orange-600 mb-4">Meals functionality is not loading properly.</p>
                  <button onclick="location.reload()" class="px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600">
                    Refresh Page
                  </button>
                </div>
              </div>
            `;
          }
        }
      }
    };
    
    setTimeout(tryRenderMeals, 500);
  }
}, [currentView]);

      // Enhanced profile tab rendering
useEffect(() => {
  if (currentView === 'profile') {
    clearContainer('profile-container');
    
    let retryCount = 0;
    const maxRetries = 10;
    
    const tryRenderProfile = () => {
      if (window.FuelIQProfile && window.FuelIQProfile.renderProfileTab) {
        try {
          window.FuelIQProfile.renderProfileTab('profile-container');
          console.log('✅ Profile tab rendered successfully');
        } catch (error) {
          console.error('Error rendering profile tab:', error);
        }
      } else {
        retryCount++;
        if (retryCount < maxRetries) {
          console.log(`⏳ Waiting for FuelIQProfile module... (${retryCount}/${maxRetries})`);
          setTimeout(tryRenderProfile, 200);
        } else {
          console.warn('❌ FuelIQProfile module failed to load');
        }
      }
    };
    
    setTimeout(tryRenderProfile, 100);
  }
}, [currentView]);
      // Simplified pantry tab rendering
useEffect(() => {
  if (currentView === 'pantry') {
    clearContainer('pantry-container');
    
    let retryCount = 0;
    const maxRetries = 3;
    
    const tryRenderPantry = () => {
      if (window.FuelIQPantry && window.FuelIQPantry.renderSmartPantry) {
        try {
          window.FuelIQPantry.renderSmartPantry('pantry-container');
          console.log('✅ Pantry tab rendered successfully');
        } catch (error) {
          console.error('Error rendering pantry tab:', error);
        }
      } else {
        retryCount++;
        if (retryCount < maxRetries) {
          console.log(`⏳ Waiting for pantry module... (${retryCount}/${maxRetries})`);
          setTimeout(tryRenderPantry, 1000);
        } else {
          console.warn('❌ Pantry module failed to load');
          const container = document.getElementById('pantry-container');
          if (container) {
            container.innerHTML = `
              <div class="max-w-6xl mx-auto p-6">
                <div class="bg-green-50 border border-green-200 rounded-xl p-6">
                  <h2 class="text-xl font-bold text-green-800 mb-2">🛒 Pantry Tab Issue</h2>
                  <p class="text-green-600 mb-4">Pantry functionality is not loading properly.</p>
                  <button onclick="location.reload()" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600">
                    Refresh Page
                  </button>
                </div>
              </div>
            `;
          }
        }
      }
    };
    
    setTimeout(tryRenderPantry, 500);
  }
}, [currentView]);

      // Enhanced meal planning tab rendering
      useEffect(() => {
        if (currentView === 'planning') {
          clearContainer('planning-container');
          
          let retryCount = 0;
          const maxRetries = 10;
          
          const tryRenderPlanning = () => {
            if (window.FuelIQMealPlanning && window.FuelIQMealPlanning.renderMealPlanning) {
              try {
                window.FuelIQMealPlanning.renderMealPlanning('planning-container');
                console.log('✅ Planning tab rendered successfully');
              } catch (error) {
                console.error('Error rendering planning tab:', error);
              }
            } else {
              retryCount++;
              if (retryCount < maxRetries) {
                console.log(`⏳ Waiting for FuelIQMealPlanning module... (${retryCount}/${maxRetries})`);
                setTimeout(tryRenderPlanning, 200);
              } else {
                console.warn('❌ FuelIQMealPlanning module failed to load');
              }
            }
          };
          
          setTimeout(tryRenderPlanning, 100);
        }
      }, [currentView]);

      // Enhanced grocery delivery tab rendering
      useEffect(() => {
        if (currentView === 'grocery') {
          clearContainer('grocery-container');
          
          let retryCount = 0;
          const maxRetries = 10;
          
          const tryRenderGrocery = () => {
            if (window.FuelIQGroceryDelivery && window.FuelIQGroceryDelivery.renderGroceryDelivery) {
              try {
                window.FuelIQGroceryDelivery.renderGroceryDelivery('grocery-container');
                console.log('✅ Grocery tab rendered successfully');
              } catch (error) {
                console.error('Error rendering grocery tab:', error);
              }
            } else {
              retryCount++;
              if (retryCount < maxRetries) {
                console.log(`⏳ Waiting for FuelIQGroceryDelivery module... (${retryCount}/${maxRetries})`);
                setTimeout(tryRenderGrocery, 200);
              } else {
                console.warn('❌ FuelIQGroceryDelivery module failed to load');
              }
            }
          };
          
          setTimeout(tryRenderGrocery, 100);
        }
      }, [currentView]);

      // Enhanced analytics tab rendering
      useEffect(() => {
        if (currentView === 'analytics') {
          clearContainer('analytics-container');
          
          let retryCount = 0;
          const maxRetries = 10;
          
          const tryRenderAnalytics = () => {
            if (window.FuelIQAnalytics && window.FuelIQAnalytics.renderAnalyticsTab) {
              try {
                window.FuelIQAnalytics.renderAnalyticsTab('analytics-container');
                console.log('✅ Analytics tab rendered successfully');
              } catch (error) {
                console.error('Error rendering analytics tab:', error);
              }
            } else {
              retryCount++;
              if (retryCount < maxRetries) {
                console.log(`⏳ Waiting for FuelIQAnalytics module... (${retryCount}/${maxRetries})`);
                setTimeout(tryRenderAnalytics, 200);
              } else {
                console.warn('❌ FuelIQAnalytics module failed to load');
              }
            }
          };
          
          setTimeout(tryRenderAnalytics, 100);
        }
      }, [currentView]);

      // Enhanced wearables tab rendering
      useEffect(() => {
        if (currentView === 'wearables') {
          clearContainer('wearables-container');
          
          let retryCount = 0;
          const maxRetries = 10;
          
          const tryRenderWearables = () => {
            if (window.FuelIQWearables && window.FuelIQWearables.renderWearablesHub) {
              try {
                window.FuelIQWearables.renderWearablesHub('wearables-container');
                console.log('✅ Wearables tab rendered successfully');
              } catch (error) {
                console.error('Error rendering wearables tab:', error);
              }
            } else {
              retryCount++;
              if (retryCount < maxRetries) {
                console.log(`⏳ Waiting for FuelIQWearables module... (${retryCount}/${maxRetries})`);
                setTimeout(tryRenderWearables, 200);
              } else {
                console.warn('❌ FuelIQWearables module failed to load');
              }
            }
          };
          
          setTimeout(tryRenderWearables, 100);
        }
      }, [currentView]);

      // Add navigation event listener with enhanced cleanup
      useEffect(() => {
        const handleNavigation = (event) => {
          forceCleanup();
          setTimeout(() => {
            setCurrentView(event.detail);
          }, 100);
        };
        
        window.addEventListener('navigateToTab', handleNavigation);
        
        return () => {
          window.removeEventListener('navigateToTab', handleNavigation);
          forceCleanup();
        };
      }, []);

      // Calculate current nutrition totals
      const totals = useMemo(() => {
        const today = new Date().toISOString().split('T')[0];
        const key = `fueliq_meals_${today}`;
        try {
          const data = JSON.parse(localStorage.getItem(key) || '{}');
          const allFoods = [...(data.breakfast||[]), ...(data.lunch||[]), ...(data.dinner||[]), ...(data.snacks||[])];
          return allFoods.reduce((acc, item) => {
            const mult = (item.servingSize || 100) / 100;
            return {
              calories: acc.calories + ((item.calories || 0) * mult),
              protein: acc.protein + ((item.protein || 0) * mult),
              carbs: acc.carbs + ((item.carbs || 0) * mult),
              fat: acc.fat + ((item.fat || 0) * mult),
              fiber: acc.fiber + ((item.fiber || 0) * mult)
            };
          }, { calories: 0, protein: 0, carbs: 0, fat: 0, fiber: 0 });
        } catch (e) {
          return { calories: 0, protein: 0, carbs: 0, fat: 0, fiber: 0 };
        }
      }, [currentView]);

      // Navigation component
      function Navigation() {
        const [isNavigating, setIsNavigating] = useState(false);
        
        const handleNavClick = (targetView) => {
  if (isNavigating) return;
  
  setIsNavigating(true);
  
  // Force clear profile container when navigating to dashboard
  if (targetView === 'dashboard') {
    const profileContainer = document.getElementById('profile-container');
    if (profileContainer) {
      profileContainer.innerHTML = '';
    }
  }
  
  forceCleanup();
  
  setTimeout(() => {
    setCurrentView(targetView);
    setIsNavigating(false);
    console.log(`✅ Navigated to: ${targetView}`);
  }, 100);
};
        
        return e('div', { className: "bg-gradient-orange-red shadow-xl" },
          e('div', { className: "max-w-7xl mx-auto px-6" },
            e('div', { className: "flex items-center justify-between py-4" },
              e('div', { className: "flex items-center space-x-4" },
                e('div', { className: "flex items-center space-x-2" },
                  e('div', { className: "w-10 h-10 bg-white rounded-xl flex items-center justify-center" },
                    e('span', { className: "text-2xl text-orange-600" }, '⚡')
                  ),
                  e('h1', { 
                    className: "text-2xl font-bold text-white tracking-tight", 
                    style: {fontFamily: 'Georgia, Times, serif'} 
                  }, "FuelIQ")
                )
              ),
              
              e('div', { className: "flex space-x-1 bg-white/10 rounded-2xl p-1 overflow-x-auto backdrop-blur-sm" },
               [
                  { id: 'profile', label: 'Profile', icon: '👤' },
                  { id: 'dashboard', label: 'Dashboard', icon: '📊', highlight: true },
                  { id: 'meals', label: 'Meals', icon: '🍽️' },
                  { id: 'pantry', label: 'Pantry', icon: '🛒' },
                  { id: 'planning', label: 'Planning', icon: '📅' },
                  { id: 'grocery', label: 'Delivery', icon: '🚚' },
                  { id: 'wearables', label: 'Devices', icon: '⌚' },
                  { id: 'analytics', label: 'Analytics', icon: '📈' },
                  { id: 'chat', label: 'AI Chat', icon: '💬' }
                ].map(({ id, label, icon }) => 
                  e('button', {
                    key: id,
                    onClick: () => handleNavClick(id),
                    disabled: isNavigating,
                    className: `flex items-center space-x-2 px-4 py-2 rounded-xl font-medium text-sm whitespace-nowrap transition-all duration-200 ${
  currentView === id
    ? (id === 'dashboard' ? 'bg-blue-500 text-white shadow-lg' : 'bg-white text-orange-600 shadow-lg')
    : 'text-white/80 hover:text-white hover:bg-white/10'
} ${isNavigating ? 'opacity-50 cursor-not-allowed' : ''}`
                  },
                    e('span', { className: "text-lg" }, icon),
                    e('span', { className: "hidden md:inline" }, label)
                  )
                )
              )
            )
          )
        );
      }

     // Special handling for profile tab
if (currentView === 'profile') {
  return e('div', { className: "min-h-screen bg-gradient-card" },
    e(Navigation),
    e('div', { id: "profile-container", className: "profile-tab-content" })
  );
}
      // Enhanced Dashboard view
      if (currentView === 'dashboard') {
        const now = new Date();
        const today = now.toLocaleDateString('en-US', { 
          weekday: 'long', 
          year: 'numeric', 
          month: 'long', 
          day: 'numeric' 
        });
        
        const currentTime = now.toLocaleTimeString('en-US', {
          hour: 'numeric',
          minute: '2-digit',
          hour12: true
        });
// Get goals from profile data
const profileGoals = (() => {
  try {
    const profileData = localStorage.getItem('fueliq_profile_data');
    if (profileData) {
      const parsed = JSON.parse(profileData);
      if (parsed.goals) {
        console.log('📊 Dashboard loaded goals:', parsed.goals);
        return {
          calories: parsed.goals.calories || 2000,
          protein: parsed.goals.protein || 150,
          carbs: parsed.goals.carbs || 250,
          fat: parsed.goals.fat || 67,
          water: parsed.goals.water || 64
        };
      }
    }
  } catch (e) {
    console.warn('Error loading goals:', e);
  }
  
  return { calories: 2000, protein: 150, carbs: 250, fat: 67, water: 64 };
})();
        const getProgressPercentage = (current, goal) => {
          const currentNum = parseFloat(current) || 0;
          const goalNum = parseFloat(goal) || 1;
          return Math.min((currentNum / goalNum) * 100, 100);
        };

        return e('div', { className: "min-h-screen bg-gradient-card" },
          e(Navigation),
          e('div', { className: "max-w-7xl mx-auto p-6" },
            
            // Welcome Header - ENHANCED
e('div', { className: "bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-700 rounded-3xl shadow-2xl p-8 mb-8 text-white relative overflow-hidden" },
  // Background pattern
  e('div', { className: "absolute inset-0 opacity-10" },
    e('div', { className: "absolute top-0 left-0 w-full h-full", style: { backgroundImage: 'radial-gradient(circle at 20% 50%, white 2px, transparent 2px), radial-gradient(circle at 80% 20%, white 2px, transparent 2px)', backgroundSize: '30px 30px' } })
  ),
  
  e('div', { className: "text-center relative z-10" },
    // Large dashboard icon
    e('div', { className: "w-20 h-20 bg-white/20 rounded-2xl flex items-center justify-center mx-auto mb-4 backdrop-blur-sm" },
      e('span', { className: "text-4xl" }, '📊')
    ),
    e('h1', { 
      className: "text-5xl font-bold mb-3", 
      style: {fontFamily: 'Georgia, Times, serif'} 
    }, 'Dashboard'),
    e('p', { className: "text-xl opacity-90 mb-2" }, today),
    e('p', { className: "text-lg font-semibold opacity-95" }, currentTime),
    e('div', { className: "mt-4 text-sm opacity-80" }, '📈 Your nutrition overview at a glance')
  )
),

            // Main Metrics Grid
            e('div', { className: "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8" },
              
              // Calories Card
              e('div', { 
                className: "bg-white/80 backdrop-blur-sm rounded-3xl shadow-2xl border border-white/20 p-6 cursor-pointer hover:scale-105 transition-all duration-200 group",
                onClick: () => setCurrentView('meals')
              },
                e('div', { className: 'flex items-center justify-between mb-4' },
                  e('div', { className: 'flex items-center space-x-3' },
                    e('div', { className: 'text-3xl p-3 bg-gradient-to-r from-orange-100 to-red-100 rounded-2xl group-hover:scale-110 transition-transform duration-200' }, '🍽️'),
                    e('div', null,
                      e('h3', { className: 'text-lg font-bold text-gray-800' }, 'Calories'),
                      e('p', { className: 'text-xs text-gray-600' }, 'Daily nutrition target')
                    )
                  ),
                  e('div', { className: 'text-sm font-bold bg-gradient-to-r from-orange-500 to-red-500 bg-clip-text text-transparent' }, 
                    Math.round(getProgressPercentage(totals.calories, profileGoals.calories))
                  )
                ),
                e('div', { className: 'mb-4' },
                  e('div', { className: 'flex items-baseline space-x-2' },
                    e('span', { className: 'text-3xl font-bold text-gray-900' }, Math.round(totals.calories || 0)),
                    e('span', { className: 'text-lg text-gray-600' }, 'kcal'),
                    e('span', { className: 'text-gray-400' }, '/'),
                    e('span', { className: 'text-lg text-gray-600' }, `${profileGoals.calories} kcal`)
                  )
                ),
                e('div', { className: 'w-full bg-gray-200 rounded-full h-3' },
                  e('div', {
                    className: 'bg-gradient-to-r from-orange-500 to-red-500 h-3 rounded-full transition-all duration-500',
                    style: { width: `${getProgressPercentage(totals.calories, profileGoals.calories)}%` }
                  })
                )
              ),
              
              // Water Card
              e('div', { 
                className: "bg-white/80 backdrop-blur-sm rounded-3xl shadow-2xl border border-white/20 p-6 cursor-pointer hover:scale-105 transition-all duration-200 group",
                onClick: () => alert('Water tracking coming soon! 🚰')
              },
                e('div', { className: 'flex items-center justify-between mb-4' },
                  e('div', { className: 'flex items-center space-x-3' },
                    e('div', { className: 'text-3xl p-3 bg-gradient-to-r from-cyan-100 to-blue-100 rounded-2xl group-hover:scale-110 transition-transform duration-200' }, '💧'),
                    e('div', null,
                      e('h3', { className: 'text-lg font-bold text-gray-800' }, 'Water'),
                      e('p', { className: 'text-xs text-gray-600' }, 'Stay hydrated')
                    )
                  ),
                  e('div', { className: 'text-sm font-bold text-cyan-600' }, '0%')
                ),
                e('div', { className: 'mb-4' },
                  e('div', { className: 'flex items-baseline space-x-2' },
                    e('span', { className: 'text-3xl font-bold text-gray-900' }, '0'),
                    e('span', { className: 'text-lg text-gray-600' }, 'oz'),
                    e('span', { className: 'text-gray-400' }, '/'),
                    e('span', { className: 'text-lg text-gray-600' }, `${goals.water || 64} oz`)
                  )
                ),
                e('div', { className: 'w-full bg-gray-200 rounded-full h-3' },
                  e('div', {
                    className: 'bg-gradient-to-r from-cyan-500 to-blue-500 h-3 rounded-full transition-all duration-500',
                    style: { width: '0%' }
                  })
                )
              ),
              
              // Steps Card
              e('div', { 
                className: "bg-white/80 backdrop-blur-sm rounded-3xl shadow-2xl border border-white/20 p-6 cursor-pointer hover:scale-105 transition-all duration-200 group",
                onClick: () => setCurrentView('wearables')
              },
                e('div', { className: 'flex items-center justify-between mb-4' },
                  e('div', { className: 'flex items-center space-x-3' },
                    e('div', { className: 'text-3xl p-3 bg-gradient-to-r from-green-100 to-emerald-100 rounded-2xl group-hover:scale-110 transition-transform duration-200' }, '👟'),
                    e('div', null,
                      e('h3', { className: 'text-lg font-bold text-gray-800' }, 'Steps'),
                      e('p', { className: 'text-xs text-gray-600' }, 'Daily activity goal')
                    )
                  ),
                  e('div', { className: 'text-sm font-bold text-green-600' }, '0%')
                ),
                e('div', { className: 'mb-4' },
                  e('div', { className: 'flex items-baseline space-x-2' },
                    e('span', { className: 'text-3xl font-bold text-gray-900' }, '0'),
                    e('span', { className: 'text-lg text-gray-600' }, ''),
                    e('span', { className: 'text-gray-400' }, '/'),
                    e('span', { className: 'text-lg text-gray-600' }, '10,000')
                  )
                ),
                e('div', { className: 'w-full bg-gray-200 rounded-full h-3' },
                  e('div', {
                    className: 'bg-gradient-to-r from-green-500 to-emerald-500 h-3 rounded-full transition-all duration-500',
                    style: { width: '0%' }
                  })
                )
              ),
              
              // Sleep Card
              e('div', { 
                className: "bg-white/80 backdrop-blur-sm rounded-3xl shadow-2xl border border-white/20 p-6 cursor-pointer hover:scale-105 transition-all duration-200 group",
                onClick: () => alert('Sleep tracking coming soon! 🌙')
              },
                e('div', { className: 'flex items-center justify-between mb-4' },
                  e('div', { className: 'flex items-center space-x-3' },
                    e('div', { className: 'text-3xl p-3 bg-gradient-to-r from-purple-100 to-pink-100 rounded-2xl group-hover:scale-110 transition-transform duration-200' }, '😴'),
                    e('div', null,
                      e('h3', { className: 'text-lg font-bold text-gray-800' }, 'Sleep'),
                      e('p', { className: 'text-xs text-gray-600' }, 'Rest & recovery')
                    )
                  ),
                  e('div', { className: 'text-sm font-bold text-purple-600' }, '0%')
                ),
                e('div', { className: 'mb-4' },
                  e('div', { className: 'flex items-baseline space-x-2' },
                    e('span', { className: 'text-3xl font-bold text-gray-900' }, '0h'),
                    e('span', { className: 'text-lg text-gray-600' }, ''),
                    e('span', { className: 'text-gray-400' }, '/'),
                    e('span', { className: 'text-lg text-gray-600' }, '8h')
                  )
                ),
                e('div', { className: 'w-full bg-gray-200 rounded-full h-3' },
                  e('div', {
                    className: 'bg-gradient-to-r from-purple-500 to-pink-500 h-3 rounded-full transition-all duration-500',
                    style: { width: '0%' }
                  })
                )
              )
            ),

            // Secondary Information Row
            e('div', { className: "grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8" },
              
              // Macro Breakdown
              e('div', { className: 'bg-white/80 backdrop-blur-sm rounded-3xl shadow-2xl p-8 border border-white/20' },
                e('h3', { className: 'text-2xl font-bold text-gray-800 mb-6 flex items-center' },
                  e('span', { className: 'mr-3 text-2xl' }, '📊'),
                  'Macro Breakdown'
                ),
                e('div', { className: 'grid grid-cols-2 gap-6' },
                  // Protein
                  e('div', { className: 'space-y-3' },
                    e('div', { className: 'flex justify-between items-center' },
                      e('span', { className: 'font-bold text-gray-800' }, 'Protein'),
                      e('span', { className: 'text-sm font-medium text-gray-600' }, 
                        `${Math.round(totals.protein || 0)}/${profileGoals.protein}g`
                      )
                    ),
                    e('div', { className: 'w-full bg-gray-200 rounded-full h-3' },
                      e('div', {
                        className: 'bg-gradient-to-r from-red-500 to-pink-500 h-3 rounded-full transition-all duration-500',
                        style: { width: `${getProgressPercentage(totals.protein, profileGoals.protein)}%` }
                      })
                    )
                  ),
                  // Carbs
                  e('div', { className: 'space-y-3' },
                    e('div', { className: 'flex justify-between items-center' },
                      e('span', { className: 'font-bold text-gray-800' }, 'Carbs'),
                      e('span', { className: 'text-sm font-medium text-gray-600' }, 
                        `${Math.round(totals.carbs || 0)}/${profileGoals.carbs}g`
                      )
                    ),
                    e('div', { className: 'w-full bg-gray-200 rounded-full h-3' },
                      e('div', {
                        className: 'bg-gradient-to-r from-yellow-500 to-orange-500 h-3 rounded-full transition-all duration-500',
                        style: { width: `${getProgressPercentage(totals.carbs, profileGoals.carbs)}%` }
                      })
                    )
                  ),
                  // Fat
                  e('div', { className: 'space-y-3' },
                    e('div', { className: 'flex justify-between items-center' },
                      e('span', { className: 'font-bold text-gray-800' }, 'Fat'),
                      e('span', { className: 'text-sm font-medium text-gray-600' }, 
                        `${Math.round(totals.fat || 0)}/${profileGoals.fat}g`
                      )
                    ),
                    e('div', { className: 'w-full bg-gray-200 rounded-full h-3' },
                      e('div', {
                        className: 'bg-gradient-to-r from-purple-500 to-indigo-500 h-3 rounded-full transition-all duration-500',
                        style: { width: `${getProgressPercentage(totals.fat, profileGoals.fat)}%` }
                      })
                    )
                  ),
                  // Fiber
                  e('div', { className: 'space-y-3' },
                    e('div', { className: 'flex justify-between items-center' },
                      e('span', { className: 'font-bold text-gray-800' }, 'Fiber'),
                      e('span', { className: 'text-sm font-medium text-gray-600' }, 
                        `${Math.round(totals.fiber || 0)}/25g`
                      )
                    ),
                    e('div', { className: 'w-full bg-gray-200 rounded-full h-3' },
                      e('div', {
                        className: 'bg-gradient-to-r from-green-500 to-emerald-500 h-3 rounded-full transition-all duration-500',
                        style: { width: `${getProgressPercentage(totals.fiber || 0, 25)}%` }
                      })
                    )
                  )
                )
              ),
              
              // Quick Actions Card
              e('div', { className: "bg-white/80 backdrop-blur-sm rounded-3xl shadow-2xl p-8 border border-white/20" },
                e('h3', { className: "text-2xl font-bold text-gray-800 mb-6 flex items-center" },
                  e('span', { className: 'mr-3 text-2xl' }, '⚡'),
                  'Quick Actions'
                ),
                e('div', { className: "grid grid-cols-2 gap-4" },
                  e('button', {
                    className: "p-6 bg-gradient-to-br from-orange-500 to-red-600 rounded-2xl text-white shadow-xl transform hover:scale-105 transition-all duration-200 group text-center",
                    onClick: () => setCurrentView('meals')
                  },
                    e('span', { className: 'text-3xl block mb-2 group-hover:scale-110 transition-transform duration-200' }, '🍽️'),
                    e('span', { className: 'font-bold text-lg' }, 'Log Meal')
                  ),
                  e('button', {
                    className: "p-6 bg-gradient-to-br from-green-500 to-emerald-600 rounded-2xl text-white shadow-xl transform hover:scale-105 transition-all duration-200 group text-center",
                    onClick: () => setCurrentView('planning')
                  },
                    e('span', { className: 'text-3xl block mb-2 group-hover:scale-110 transition-transform duration-200' }, '📅'),
                    e('span', { className: 'font-bold text-lg' }, 'Plan Meals')
                  ),
                  e('button', {
                    className: "p-6 bg-gradient-to-br from-purple-500 to-pink-600 rounded-2xl text-white shadow-xl transform hover:scale-105 transition-all duration-200 group text-center",
                    onClick: () => setCurrentView('journey')
                  },
                    e('span', { className: 'text-3xl block mb-2 group-hover:scale-110 transition-transform duration-200' }, '⚖️'),
                    e('span', { className: 'font-bold text-lg' }, 'Log Weight')
                  ),
                  e('button', {
                    className: "p-6 bg-gradient-to-br from-cyan-500 to-blue-600 rounded-2xl text-white shadow-xl transform hover:scale-105 transition-all duration-200 group text-center",
                    onClick: () => setCurrentView('wearables')
                  },
                    e('span', { className: 'text-3xl block mb-2 group-hover:scale-110 transition-transform duration-200' }, '⌚'),
                    e('span', { className: 'font-bold text-lg' }, 'Connect Device')
                  )
                )
              )
            ),

            // Health Insights Card
            e('div', { className: "bg-gradient-to-r from-orange-500 via-red-600 to-pink-600 rounded-3xl shadow-2xl p-8 text-white" },
              e('h3', { className: "text-2xl font-bold mb-6 flex items-center" },
                e('span', { className: 'mr-3 text-2xl' }, '💡'),
                'Health Insights'
              ),
              e('div', { className: "grid grid-cols-1 md:grid-cols-3 gap-6" },
                e('div', { className: "bg-white/20 rounded-2xl p-6 backdrop-blur-sm" },
                  e('h4', { className: "font-bold text-lg mb-3" }, 'Nutrition Progress'),
                  e('p', { className: "text-sm opacity-90 leading-relaxed" }, 
                    `You've consumed ${Math.round((totals.calories / (profileGoals.calories)) * 100)}% of your daily calorie goal. ${totals.calories > 0 ? 'Great start!' : 'Ready to fuel your day?'}`
                  )
                ),
                e('div', { className: "bg-white/20 rounded-2xl p-6 backdrop-blur-sm" },
                  e('h4', { className: "font-bold text-lg mb-3" }, 'Device Integration'),
                  e('p', { className: "text-sm opacity-90 leading-relaxed" }, 
                    'Connect your fitness tracker to automatically sync steps, sleep, and health data!'
                  )
                ),
                e('div', { className: "bg-white/20 rounded-2xl p-6 backdrop-blur-sm" },
                  e('h4', { className: "font-bold text-lg mb-3" }, 'Stay Consistent'),
                  e('p', { className: "text-sm opacity-90 leading-relaxed" }, 
                    'Track your nutrition daily for optimal results and lasting healthy habits.'
                  )
                )
              )
            )
          )
        );
      }

      

      // Special handling for meals tab
      if (currentView === 'meals') {
        return e('div', { className: "min-h-screen bg-gradient-card" },
          e(Navigation),
          e('div', { id: "meals-container", className: "meals-tab-content" })
        );
      }

      // Special handling for pantry tab
      if (currentView === 'pantry') {
        return e('div', { className: "min-h-screen bg-gradient-card" },
          e(Navigation),
          e('div', { id: "pantry-container", className: "pantry-tab-content" })
        );
      }

      // Special handling for meal planning tab
      if (currentView === 'planning') {
        return e('div', { className: "min-h-screen bg-gradient-card" },
          e(Navigation),
          e('div', { id: "planning-container", className: "planning-tab-content" })
        );
      }

      // Special handling for grocery delivery tab
      if (currentView === 'grocery') {
        return e('div', { className: "min-h-screen bg-gradient-card" },
          e(Navigation),
          e('div', { id: "grocery-container", className: "grocery-tab-content" })
        );
      }

      // Special handling for analytics tab
      if (currentView === 'analytics') {
        return e('div', { className: "min-h-screen bg-gradient-card" },
          e(Navigation),
          e('div', { id: "analytics-container", className: "analytics-tab-content" })
        );
      }

      // Special handling for wearables tab
      if (currentView === 'wearables') {
        return e('div', { className: "min-h-screen bg-gradient-card" },
          e(Navigation),
          e('div', { id: "wearables-container", className: "wearables-tab-content" })
        );
      }

      // Default view for other sections
      return e('div', { className: "min-h-screen bg-gradient-card" },
        e(Navigation),
        e('div', { className: "max-w-6xl mx-auto p-6" },
          e('div', { className: "bg-white/80 backdrop-blur-sm rounded-3xl shadow-2xl p-8 border border-white/20 text-center" },
            e('div', { className: "w-20 h-20 bg-gradient-to-br from-orange-500 to-red-600 rounded-2xl flex items-center justify-center mx-auto mb-6" },
              e('span', { className: "text-4xl text-white" }, '⚙️')
            ),
            e('h2', { className: "text-3xl font-bold mb-4 text-gradient" },
              {
                'profile': 'Profile',
                'meals': 'Food Logging',
                'pantry': 'Smart Pantry',
                'planning': 'Meal Planning',
                'grocery': 'Grocery Delivery',
                'wearables': 'Wearable Devices',
                'analytics': 'Analytics & Reports',
                'chat': 'AI Assistant'
              }[currentView] || 'Feature Coming Soon'
            ),
            e('p', { className: "text-xl text-gray-600 mb-8" }, "This section is coming soon with enhanced features!"),
            e('button', {
              onClick: () => setCurrentView('dashboard'),
              className: "px-8 py-4 bg-gradient-to-r from-orange-500 to-red-600 text-white rounded-2xl hover:from-orange-600 hover:to-red-700 font-bold text-lg shadow-xl transform hover:scale-105 transition-all duration-200"
            }, "Back to Dashboard")
          )
        )
      );
    }

    ReactDOM.render(e(FuelIQ), document.getElementById('root'));
  </script>
</body>
</html>
